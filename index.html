<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>關於愛情的味覺測驗</title>
    
    <!-- Open Graph Tags (LINE/FB 分享縮圖設定) -->
    <meta property="og:title" content="關於愛情的味覺測驗" />
    <meta property="og:description" content="測測看妳渴望什麼樣的愛情？領取專屬妳的愛情開運年菜！" />
    <meta property="og:image" content="https://i.postimg.cc/76Lk57Z0/Red-Hearts-Valentine-s-Day-Promo-Love-Instagram-Post.png" />
    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://hellosarahttlc-dotcom.github.io/newyear/" />

    <!-- 引入日系質感圓體 Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Zen+Maru+Gothic:wght@400;700&family=Noto+Sans+TC:wght@400;700&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --primary-red: #a65e5e;   /* 莫蘭迪紅 */
            --dark-red: #7d2d2d;      /* 深酒紅 */
            --title-red: #3d1414;     /* 極深紅褐色 */
            --deep-bg: #5c1f1f;       /* 極深背景 */
            --cream-white: #fcf9f7;   /* 奶油白 */
            --sketch-radius: 20px 8px 25px 12px/8px 20px 12px 25px;
        }

        * { 
            box-sizing: border-box; 
            -webkit-tap-highlight-color: transparent; 
        }

        body {
            font-family: 'Zen Maru Gothic', 'Noto Sans TC', sans-serif;
            background-color: var(--deep-bg);
            color: var(--cream-white);
            margin: 0;
            padding: 10px; 
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            line-height: 1.6;
            overflow-x: hidden;
        }

        /* 測驗外框 */
        #quiz-app {
            width: 100%;
            max-width: 360px;
            background: var(--primary-red);
            padding: 40px 15px; 
            border-radius: 40px;
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.5);
            text-align: center;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            border: 1px solid rgba(252, 249, 247, 0.1);
            position: relative;
            min-height: 520px;
        }

        .page { 
            display: none; 
            width: 100%; 
            animation: fadeIn 0.4s ease-out forwards; 
        }
        
        .page.active { 
            display: flex; 
            flex-direction: column; 
            align-items: center; 
            justify-content: center;
        }

        @keyframes fadeIn { 
            from { opacity: 0; transform: translateY(10px); } 
            to { opacity: 1; transform: translateY(0); } 
        }

        h1 { 
            color: var(--title-red); 
            font-size: 1.6rem; 
            margin: 0; 
            letter-spacing: 4px; 
            font-weight: 700; 
            line-height: 1.2;
            width: 100%;
        }
        
        .subtitle { 
            font-size: 0.9rem; 
            color: var(--cream-white); 
            margin: 10px 0 20px 0; 
            letter-spacing: 2px; 
            opacity: 0.95;
            width: 100%;
        }
        
        .home-wish { 
            font-size: 0.8rem; 
            color: var(--cream-white); 
            margin: 20px 0 0 0; 
            font-weight: 500; 
            opacity: 0.8;
            width: 100%;
        }

        .question-num { 
            font-size: 0.7rem; 
            color: var(--title-red); 
            margin-bottom: 10px; 
            letter-spacing: 2.5px; 
            font-weight: 800; 
        }
        
        h2 {
            font-size: clamp(1rem, 4.5vw, 1.15rem);
            margin: 0 auto 30px auto; 
            font-weight: 700; 
            color: var(--cream-white);
            line-height: 1.6; 
            text-align: center; 
            width: 100%;
        }

        /* 第四題單行特別控制 */
        .page[data-qidx="3"] h2 { 
            white-space: nowrap !important; 
            letter-spacing: -0.5px; 
            font-size: clamp(0.9rem, 4.2vw, 1.1rem); 
        }

        .options { 
            width: 100%; 
            display: flex; 
            flex-direction: column; 
            gap: 12px; 
        }
        
        .options button {
            width: 100%; 
            padding: 14px 12px; 
            border: none; 
            border-radius: var(--sketch-radius);
            background: var(--cream-white); 
            font-family: 'Zen Maru Gothic', sans-serif;
            font-size: 0.95rem; 
            color: var(--title-red); 
            font-weight: 700;
            cursor: pointer; 
            transition: all 0.2s ease;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
            line-height: 1.4; 
        }
        
        .options button:active { background-color: var(--dark-red); color: var(--cream-white); transform: scale(0.97); }

        /* 結果頁佈局核心修正 */
        .result-dish-box {
            background: var(--cream-white); 
            color: var(--title-red);
            padding: 10px 20px; 
            border-radius: var(--sketch-radius);
            margin: 5px 0 20px 0; 
            display: inline-block;
            box-shadow: 0 4px 15px rgba(0,0,0,0.15);
            max-width: 90%;
        }
        
        .result-dish { 
            font-size: 1.5rem; 
            font-weight: 700; 
            letter-spacing: 3px; 
            margin: 0; 
        }
        
        .result-desc { 
            font-size: 0.95rem; 
            margin-bottom: 20px; 
            text-align: center; 
            color: var(--cream-white); 
            line-height: 1.8; 
            padding: 0 5px;
            width: 100%;
            word-break: break-word; /* 允許英文斷行，中文不強制 keep-all */
        }
        
        .result-quote { 
            font-style: italic; 
            color: var(--title-red); 
            margin: 15px 0; 
            padding: 20px 15px; 
            border-top: 1.5px dashed rgba(252, 249, 247, 0.3); 
            border-bottom: 1.5px dashed rgba(252, 249, 247, 0.3); 
            font-weight: 700; 
            font-size: 1.05rem; 
            line-height: 1.7; 
            background: rgba(252, 249, 247, 0.05); 
            border-radius: 15px;
            width: 100%;
            word-break: break-word;
        }
        
        .btn-main {
            background: var(--title-red); 
            color: var(--cream-white); 
            border: none;
            padding: 15px 45px; 
            border-radius: 40px; 
            font-family: 'Zen Maru Gothic', sans-serif;
            font-size: 1.05rem; 
            font-weight: 700; 
            cursor: pointer;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3); 
            transition: 0.3s;
            margin-top: 5px;
        }
        
        .btn-main:active { transform: scale(0.95); }

        .closing-wish { 
            font-size: 0.85rem; 
            color: var(--title-red); 
            margin: 25px 0 0 0; 
            font-weight: 800; 
            letter-spacing: 1.5px; 
            width: 100%;
            line-height: 1.6;
            text-align: center; /* 置中祝福 */
            display: block;
        }
    </style>
</head>
<body>

<div id="quiz-app">
    <!-- 首頁 -->
    <div class="page active" id="p-start">
        <h1>關於愛情的味覺測驗</h1>
        <p class="subtitle">測出你渴望的關係風格</p>
        <button class="btn-main" onclick="goToStep(1)">開始測驗</button>
        <p class="home-wish">新春佳節，送給親愛的你</p>
    </div>

    <!-- 問題容器 -->
    <div id="questions-container"></div>

    <!-- 結果頁 -->
    <div class="page" id="p-result">
        <p style="font-size: 0.8rem; margin-bottom: 4px; color: var(--title-red); letter-spacing: 2px; font-weight: 700;">你渴望的關係風格是</p>
        <div class="result-dish-box"><div class="result-dish" id="res-title"></div></div>
        <div class="result-desc" id="res-desc"></div>
        <div class="result-quote" id="res-quote"></div>
        <button class="btn-main" onclick="location.reload()">重新測驗</button>
        <div class="closing-wish">祝大家新年快樂，<br>也期待 6/6 與你相見。</div>
    </div>
</div>

<script>
    const quizData = [
        { q: "新春第一天早晨醒來，腦中浮現的第一個念頭是？", a: "期待熱鬧的團圓飯", b: "安靜地睡到自然醒", c: "傳訊息給好友拜年" },
        { q: "如果要在婚禮當天選一個顏色穿，你直覺會選？", a: "存在感十足的亮色系", b: "溫柔低調色", c: "個性深色系" },
        { q: "在充滿祝福的婚禮現場，你通常如何參與其中？", a: "大笑聊天帶氣氛", b: "靜靜看大家開心", c: "和熟人深度敘舊" },
        { q: "你覺得這對新人的組合最像什麼？", a: "一個負責熱鬧，一個負責安穩", b: "百搭灰白色與點亮生活的色彩", c: "理性導航與直覺冒險家" },
        { q: "如果在年貨大街只能帶走一樣，你會選擇？", a: "澎湃豪華的精緻禮盒", b: "家常味十足的零食", c: "設計獨特的文創春聯" },
        { q: "感受到幸福時，你通常會如何表達？", a: "高調上傳限時動態", b: "默默珍藏在心底", c: "寫成文字記錄下來" },
        { q: "關於新郎的神祕特質，當天你會如何「守護」他？", a: "鏡頭鎖定新娘，讓他當個帥氣背景", b: "禮貌點頭，不強迫社交", c: "幫忙擋酒，不讓他喝醉" },
        { q: "新年願望中，你最希望 2026 的生活節奏是？", a: "精彩繽紛，每一天有驚喜", b: "平穩踏實，感受每個當下", c: "隨心所欲，在獨處與熱鬧間切換" },
        { q: "婚禮當天踏入現場，最吸引你目光的環節會是？", a: "浪漫進場，感受閃耀時刻", b: "誠摯誓詞，見證真誠約定", c: "溫馨互動，與好朋友寒暄" },
        { q: "對於即將到來的 6 月婚禮，你最期待的是？", a: "準備好熱情，當天大家嗨起來", b: "謝謝邀請，期待看見你們最自在的樣子", c: "感受到那份純粹的喜悅" }
    ];

    const resultData = [
        { title: "鮮甜大蝦盤", desc: "你渴望的愛是「明亮且純粹」。不喜歡猜忌與保留，你期待一段能讓你卸下武裝、自在發光的關係。", quote: "愛是能讓你在此刻，看見最坦然、最燦爛的自己。" },
        { title: "開運紅燒魚", desc: "你渴望的愛是「平衡且優雅」。你嚮往一段能互相尊重、保有各自空間，卻又能在細微處共鳴的靈魂陪伴。", quote: "在共有的生活裡，依然保有那份屬於你的自在與優雅。" },
        { title: "火辣醉雞腿", desc: "你渴望的愛是「深刻且獨特」。你期待的是一種不流於表面、帶有神祕感且後勁十足的知心連結。", quote: "你的獨特與神祕，本身就是愛裡最迷人的風景。" },
        { title: "暖心佛跳牆", desc: "你渴望的愛是「厚實且包容」。你嚮往那種經得起時間細火慢燉，能接住你所有情緒與層次的深層避風港。", quote: "願你擁有一份能承接你所有樣貌的溫厚與深情。" },
        { title: "酥脆炸年糕", desc: "你渴望的愛是「純真且軟甜」。儘管外表堅強，你內心其實留了一個位置，期待被某個人溫柔地融化。", quote: "願你的那份柔軟與甜美，都能被溫柔地珍藏著。" },
        { title: "暖心干貝雞湯", desc: "你渴望的愛是「安定且療癒」。你期待的不是轟轟烈烈，而是當世界紛擾時，轉過身就能感受到的那份踏實。", quote: "最簡單的安穩，是你在某個人的身邊感到無比平安。" },
        { title: "澎湃長年菜", desc: "你渴望的愛是「堅韌且長情」。你相信最好的關係是回甘與陪伴，是種經得起日常消磨卻依然存在的守護。", quote: "在平淡的日常裡，願你擁有一份最安靜且深刻的堅定。" },
        { title: "精緻什錦菜", desc: "你渴望的愛是「靈動且自由」。你不喜歡被套公式，期待一段能一起探索世界、共同成長且不被定義的愛情。", quote: "你靈魂裡的自由與靈性，就是愛最動人的模樣。" },
        { title: "招財金餃子", desc: "你渴望的愛是「踏實且真誠」。你嚮往一種不在乎虛華表象，願意在每個日常節裡默默支持彼此的愛。", quote: "在平凡的生活裡，願你擁有最紮實且真摯的守護。" },
        { title: "圓滿小湯圓", desc: "你渴望的愛是「溫潤且連結」。你期待一種像糖水般溫慢，能將彼此的心輕輕貼在一起的柔軟力量。", quote: "願這份細膩的溫柔，始終陪伴著你與你珍視的人。" }
    ];

    const dishCounts = [
        [3, 4, 3], [3, 4, 3], [3, 4, 3], [4, 3, 3], [3, 3, 4], 
        [4, 3, 3], [4, 3, 3], [3, 4, 3], [3, 3, 4], [4, 3, 3]
    ];

    let userAnswers = [];

    function createQuestions() {
        const container = document.getElementById('questions-container');
        quizData.forEach((item, index) => {
            const div = document.createElement('div');
            div.className = 'page'; 
            div.id = `page-${index}`; 
            div.setAttribute('data-qidx', index);
            let targetIndices = [0, 1, 4, 6, 7, 8, 9];
            let fq = targetIndices.includes(index) ? item.q.replace(/，/g, '，<br>') : item.q;
            div.innerHTML = `<div class="question-num">Question ${String(index+1).padStart(2,'0')}</div>
                <h2>${fq}</h2>
                <div class="options">
                    <button onclick="selectOption(0, ${index})">${item.a}</button>
                    <button onclick="selectOption(1, ${index})">${item.b}</button>
                    <button onclick="selectOption(2, ${index})">${item.c}</button>
                </div>`;
            container.appendChild(div);
        });
    }

    function goToStep(sId) {
        document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
        if (sId === 'result') document.getElementById('p-result').classList.add('active');
        else document.getElementById(`page-${sId - 1}`).classList.add('active');
        window.scrollTo(0, 0);
    }

    function selectOption(oIdx, qIdx) {
        userAnswers[qIdx] = oIdx;
        if (qIdx < quizData.length - 1) goToStep(qIdx + 2);
        else calculateAndShowResult();
    }

    function calculateAndShowResult() {
        const userA = userAnswers.filter(a => a === 0).length;
        const userB = userAnswers.filter(a => a === 1).length;
        const userC = userAnswers.filter(a => a === 2).length;
        const lastAnswer = userAnswers[9];

        let minDistance = 999;
        let tiedIndices = [];

        dishCounts.forEach((target, index) => {
            const dist = Math.sqrt(
                Math.pow(userA - target[0], 2) + Math.pow(userB - target[1], 2) + Math.pow(userC - target[2], 2)
            );
            if (dist < minDistance) {
                minDistance = dist;
                tiedIndices = [index];
            } else if (Math.abs(dist - minDistance) < 0.001) {
                tiedIndices.push(index);
            }
        });

        let resIdx = tiedIndices[0];
        if (tiedIndices.length > 1) {
            if (tiedIndices.some(i => [3, 5, 6, 9].includes(i))) {
                if (lastAnswer === 0) resIdx = 3;
                else if (lastAnswer === 1) resIdx = 5;
                else if (lastAnswer === 2) resIdx = 9;
                else resIdx = 6;
            } else if (tiedIndices.some(i => [0, 1, 2, 7].includes(i))) {
                if (lastAnswer === 0) resIdx = 0;
                else if (lastAnswer === 1) resIdx = 1;
                else if (lastAnswer === 2) resIdx = 2;
                else resIdx = 7;
            } else if (tiedIndices.some(i => [4, 8].includes(i))) {
                if (lastAnswer === 2) resIdx = 4;
                else resIdx = 8;
            }
        }

        const res = resultData[resIdx];
        document.getElementById('res-title').innerText = res.title;
        
        // 核心換行邏輯修正：只要遇到標點符號就換行，並移除多餘空白
        const formatText = (str) => {
            return str.trim().replace(/[。，]/g, (match) => match + '<br>');
        };
        
        document.getElementById('res-desc').innerHTML = formatText(res.desc);
        document.getElementById('res-quote').innerHTML = formatText(res.quote);
        
        goToStep('result');
    }
    window.onload = createQuestions;
</script>
</body>
</html>
